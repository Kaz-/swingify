<ng-container *ngIf="(playlist$ | async); then playlist; else selection"></ng-container>
<ng-template #playlist>
  <div class="header">
    <a href="{{ (playlist$ | async)?.external_urls.spotify }}" target="_blank">
      <img [src]="(playlist$ | async)?.images[0]?.url">
      <div>
        <h3>{{ (playlist$ | async)?.name }}</h3>
        <small>By {{ (playlist$ | async)?.owner.display_name }}</small>
      </div>
    </a>
    <div>
      <span class="total">{{ (tracks$ | async)?.items.length }} of {{ (tracks$ | async)?.total }} tracks</span>
      <ng-container *ngIf="{ tracks: (tracks$ | async)?.items } as items">
        <button class="green-button" [title]="isSecondary ? 'Remove loaded tracks' : 'Export loaded tracks'"
          (click)="execute(items.tracks)">
          <i class="icon {{ isSecondary ? 'minus' : 'plus' }}"></i>
        </button>
      </ng-container>
    </div>
  </div>
  <ng-container *ngIf="{ tracks: (tracks$ | async) } as list">
    <ul class="tracklist" infiniteScroll [scrollWindow]="false" (scrolled)="onScroll(list.tracks)">
      <li class="track" *ngFor="let item of (tracks$ | async)?.items">
        <i class="icon music"></i>
        <a class="track-informations" [href]="item.track.external_urls.spotify" target="_blank">
          <div class="wrapper">
            <div class="name" [title]="item.track.name">{{ item.track.name }}</div>
            <div class="from" title="{{ item.track.artists[0]?.name }} · {{ item.track.album.name }}">
              {{ item.track.artists[0]?.name }} ·	{{ item.track.album.name }}
            </div>
          </div>
          <span class="track-duration">{{ toDuration(item.track.duration_ms) }}</span>
        </a>
        <button class="{{ isSecondary ? 'red' : 'green' }}-button" [title]="isSecondary ? 'Remove' : 'Export'"
          (click)="execute(item.track.uri)">
          <i class="icon {{ isSecondary ? 'minus' : 'plus' }}"></i>
        </button>
      </li>
    </ul>
  </ng-container>
</ng-template>
<ng-template #selection>
  <h2>Playlists</h2>
  <ul class="playlists">
    <li *ngFor="let playlist of (playlists$ | async)?.items">
      <a class="playlist-link" (click)="navigate(playlist.id)">
        <img [src]="playlist.images[0]?.url">
        <div>{{ playlist.name }}</div>
      </a>
    </li>
  </ul>
</ng-template>
